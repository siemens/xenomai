<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>Xenomai: Lightweight key-to-object mapping service</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
</script>
<link rel="search" href="search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="Xenomai"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Xenomai
   &#160;<span id="projectnumber">3.0.2</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
          <div class="left">
            <form id="FSearchBox" action="search.php" method="get">
              <img id="MSearchSelect" src="search/mag.png" alt=""/>
              <input type="text" id="MSearchField" name="query" value="Search" size="20" accesskey="S" 
                     onfocus="searchBox.OnSearchFieldFocus(true)" 
                     onblur="searchBox.OnSearchFieldFocus(false)"/>
            </form>
          </div><div class="right"></div>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__cobalt__core__map.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Lightweight key-to-object mapping service<div class="ingroups"><a class="el" href="group__cobalt.html">Cobalt</a> &raquo; <a class="el" href="group__cobalt__core.html">Cobalt kernel</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>A map is a simple indexing structure which associates unique integer keys with pointers to objects.  
<a href="#details">More...</a></p>
<div class="dynheader">
Collaboration diagram for Lightweight key-to-object mapping service:</div>
<div class="dyncontent">
<center><table><tr><td><img src="group__cobalt__core__map.png" border="0" alt="" usemap="#group____cobalt____core____map"/>
<map name="group____cobalt____core____map" id="group____cobalt____core____map">
<area shape="rect" id="node2" href="group__cobalt__core.html" title="The Cobalt core is a co&#45;kernel which supplements the Linux kernel for delivering real&#45;time services w..." alt="" coords="5,13,104,39"/>
</map>
</td></tr></table></center>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga2eab70bfca466d0b42eb0297cb620dc3"><td class="memItemLeft" align="right" valign="top">struct xnmap *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cobalt__core__map.html#ga2eab70bfca466d0b42eb0297cb620dc3">xnmap_create</a> (int nkeys, int reserve, int offset)</td></tr>
<tr class="memdesc:ga2eab70bfca466d0b42eb0297cb620dc3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a map.  <a href="#ga2eab70bfca466d0b42eb0297cb620dc3">More...</a><br /></td></tr>
<tr class="separator:ga2eab70bfca466d0b42eb0297cb620dc3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9dca501381f8b650ae640d8ca24b52dc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cobalt__core__map.html#ga9dca501381f8b650ae640d8ca24b52dc">xnmap_delete</a> (struct xnmap *map)</td></tr>
<tr class="memdesc:ga9dca501381f8b650ae640d8ca24b52dc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Delete a map.  <a href="#ga9dca501381f8b650ae640d8ca24b52dc">More...</a><br /></td></tr>
<tr class="separator:ga9dca501381f8b650ae640d8ca24b52dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabde7aeda7a4fb88f2858fe278ca1ce05"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cobalt__core__map.html#gabde7aeda7a4fb88f2858fe278ca1ce05">xnmap_enter</a> (struct xnmap *map, int key, void *objaddr)</td></tr>
<tr class="memdesc:gabde7aeda7a4fb88f2858fe278ca1ce05"><td class="mdescLeft">&#160;</td><td class="mdescRight">Index an object into a map.  <a href="#gabde7aeda7a4fb88f2858fe278ca1ce05">More...</a><br /></td></tr>
<tr class="separator:gabde7aeda7a4fb88f2858fe278ca1ce05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac813a3e269b6ede21610d82fe2d70971"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cobalt__core__map.html#gac813a3e269b6ede21610d82fe2d70971">xnmap_remove</a> (struct xnmap *map, int key)</td></tr>
<tr class="memdesc:gac813a3e269b6ede21610d82fe2d70971"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove an object reference from a map.  <a href="#gac813a3e269b6ede21610d82fe2d70971">More...</a><br /></td></tr>
<tr class="separator:gac813a3e269b6ede21610d82fe2d70971"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3e669e17ddc60bb9e5e7795a0991b12b"><td class="memItemLeft" align="right" valign="top">static void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cobalt__core__map.html#ga3e669e17ddc60bb9e5e7795a0991b12b">xnmap_fetch_nocheck</a> (struct xnmap *map, int key)</td></tr>
<tr class="memdesc:ga3e669e17ddc60bb9e5e7795a0991b12b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Search an object into a map - unchecked form.  <a href="#ga3e669e17ddc60bb9e5e7795a0991b12b">More...</a><br /></td></tr>
<tr class="separator:ga3e669e17ddc60bb9e5e7795a0991b12b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga749a3a9dd50203cf273837d74f68a61c"><td class="memItemLeft" align="right" valign="top">static void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cobalt__core__map.html#ga749a3a9dd50203cf273837d74f68a61c">xnmap_fetch</a> (struct xnmap *map, int key)</td></tr>
<tr class="memdesc:ga749a3a9dd50203cf273837d74f68a61c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Search an object into a map.  <a href="#ga749a3a9dd50203cf273837d74f68a61c">More...</a><br /></td></tr>
<tr class="separator:ga749a3a9dd50203cf273837d74f68a61c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>A map is a simple indexing structure which associates unique integer keys with pointers to objects. </p>
<p>The current implementation supports reservation, for naming/indexing objects, either on a fixed, user-provided integer (i.e. a reserved key value), or by drawing the next available key internally if the caller did not specify any fixed key. For instance, in some given map, the key space ranging from 0 to 255 could be reserved for fixed keys, whilst the range from 256 to 511 could be available for drawing free keys dynamically.</p>
<p>A maximum of 1024 unique keys per map is supported on 32bit machines.</p>
<p>(This implementation should not be confused with C++ STL maps, which are dynamically expandable and allow arbitrary key types; Xenomai maps don't). </p>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga2eab70bfca466d0b42eb0297cb620dc3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct xnmap * xnmap_create </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nkeys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>reserve</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>offset</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a map. </p>
<p>Allocates a new map with the specified addressing capabilities. The memory is obtained from the Xenomai system heap.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">nkeys</td><td>The maximum number of unique keys the map will be able to hold. This value cannot exceed the static limit represented by XNMAP_MAX_KEYS, and must be a power of two.</td></tr>
    <tr><td class="paramname">reserve</td><td>The number of keys which should be kept for reservation within the index space. Reserving a key means to specify a valid key to the <a class="el" href="group__cobalt__core__map.html#gabde7aeda7a4fb88f2858fe278ca1ce05" title="Index an object into a map. ">xnmap_enter()</a> service, which will then attempt to register this exact key, instead of drawing the next available key from the unreserved index space. When reservation is in effect, the unreserved index space will hold key values greater than <em>reserve</em>, keeping the low key values for the reserved space. For instance, passing <em>reserve</em> = 32 would cause the index range [ 0 .. 31 ] to be kept for reserved keys. When non-zero, <em>reserve</em> is rounded to the next multiple of BITS_PER_LONG. If <em>reserve</em> is zero no reservation will be available from the map.</td></tr>
    <tr><td class="paramname">offset</td><td>The lowest key value <a class="el" href="group__cobalt__core__map.html#gabde7aeda7a4fb88f2858fe278ca1ce05" title="Index an object into a map. ">xnmap_enter()</a> will return to the caller. Key values will be in the range [ 0 + offset .. <em>nkeys</em> + offset - 1 ]. Negative offsets are valid.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the address of the new map is returned on success; otherwise, NULL is returned if <em>nkeys</em> is invalid.</dd></dl>
<dl class="section user"><dt>Tags</dt><dd><a class="el" href="group__cobalt__core.html">task-unrestricted</a> </dd></dl>

</div>
</div>
<a class="anchor" id="ga9dca501381f8b650ae640d8ca24b52dc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void xnmap_delete </td>
          <td>(</td>
          <td class="paramtype">struct xnmap *&#160;</td>
          <td class="paramname"><em>map</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Delete a map. </p>
<p>Deletes a map, freeing any associated memory back to the Xenomai system heap.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">map</td><td>The address of the map to delete.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Tags</dt><dd><a class="el" href="group__cobalt__core.html">task-unrestricted</a> </dd></dl>

</div>
</div>
<a class="anchor" id="gabde7aeda7a4fb88f2858fe278ca1ce05"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int xnmap_enter </td>
          <td>(</td>
          <td class="paramtype">struct xnmap *&#160;</td>
          <td class="paramname"><em>map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>objaddr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Index an object into a map. </p>
<p>Insert a new object into the given map.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">map</td><td>The address of the map to insert into.</td></tr>
    <tr><td class="paramname">key</td><td>The key to index the object on. If this key is within the valid index range [ 0 - offset .. nkeys - offset - 1 ], then an attempt to reserve this exact key is made. If <em>key</em> has an out-of-range value lower or equal to 0 - offset - 1, then an attempt is made to draw a free key from the unreserved index space.</td></tr>
    <tr><td class="paramname">objaddr</td><td>The address of the object to index on the key. This value will be returned by a successful call to <a class="el" href="group__cobalt__core__map.html#ga749a3a9dd50203cf273837d74f68a61c" title="Search an object into a map. ">xnmap_fetch()</a> with the same key.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a valid key is returned on success, either <em>key</em> if reserved, or the next free key. Otherwise:</dd></dl>
<ul>
<li>-EEXIST is returned upon attempt to reserve a busy key.</li>
<li>-ENOSPC when no more free key is available.</li>
</ul>
<dl class="section user"><dt>Tags</dt><dd><a class="el" href="group__cobalt__core.html">unrestricted</a> </dd></dl>

</div>
</div>
<a class="anchor" id="ga749a3a9dd50203cf273837d74f68a61c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void xnmap_fetch </td>
          <td>(</td>
          <td class="paramtype">struct xnmap *&#160;</td>
          <td class="paramname"><em>map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Search an object into a map. </p>
<p>Retrieve an object reference from the given map by its index key.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">map</td><td>The address of the map to retrieve from.</td></tr>
    <tr><td class="paramname">key</td><td>The key to be searched for in the map index.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The indexed object address is returned on success, otherwise NULL is returned when <em>key</em> is invalid or no object is currently indexed on it.</dd></dl>
<dl class="section user"><dt>Tags</dt><dd><a class="el" href="group__cobalt__core.html">unrestricted</a> </dd></dl>

</div>
</div>
<a class="anchor" id="ga3e669e17ddc60bb9e5e7795a0991b12b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void xnmap_fetch_nocheck </td>
          <td>(</td>
          <td class="paramtype">struct xnmap *&#160;</td>
          <td class="paramname"><em>map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Search an object into a map - unchecked form. </p>
<p>Retrieve an object reference from the given map by its index key, but does not perform any sanity check on the provided key.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">map</td><td>The address of the map to retrieve from.</td></tr>
    <tr><td class="paramname">key</td><td>The key to be searched for in the map index.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The indexed object address is returned on success, otherwise NULL is returned when no object is currently indexed on <em>key</em>.</dd></dl>
<dl class="section user"><dt>Tags</dt><dd><a class="el" href="group__cobalt__core.html">unrestricted</a> </dd></dl>

</div>
</div>
<a class="anchor" id="gac813a3e269b6ede21610d82fe2d70971"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int xnmap_remove </td>
          <td>(</td>
          <td class="paramtype">struct xnmap *&#160;</td>
          <td class="paramname"><em>map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Remove an object reference from a map. </p>
<p>Removes an object reference from the given map, releasing the associated key.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">map</td><td>The address of the map to remove from.</td></tr>
    <tr><td class="paramname">key</td><td>The key the object reference to be removed is indexed on.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 is returned on success. Otherwise:</dd></dl>
<ul>
<li>-ESRCH is returned if <em>key</em> is invalid.</li>
</ul>
<dl class="section user"><dt>Tags</dt><dd><a class="el" href="group__cobalt__core.html">unrestricted</a> </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.10 </li>
  </ul>
</div>
</body>
</html>
