<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Xenomai API: Interrupt Management Services</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#define-members">Defines</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<h1>Interrupt Management Services<br/>
<small>
[<a class="el" href="group__driverapi.html">Driver Development API</a>]</small>
</h1>  </div>
</div>
<div class="contents">

<p><div class="dynheader">
Collaboration diagram for Interrupt Management Services:</div>
<div class="dyncontent">
<center><table><tr><td><img src="group__rtdmirq.png" border="0" alt="" usemap="#group____rtdmirq"/>
<map name="group____rtdmirq" id="group____rtdmirq">
<area shape="rect" id="node2" href="group__driverapi.html" title="Driver Development API" alt="" coords="7,5,180,35"/></map>
</td></tr></table></center>
</div>
</p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__rtdmirq.html#gac99789fe8b6b48e032ee6c22544968e4">rtdm_irq_get_arg</a>(irq_handle, type)&nbsp;&nbsp;&nbsp;((type *)irq_handle-&gt;cookie)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Retrieve IRQ handler argument.  <a href="#gac99789fe8b6b48e032ee6c22544968e4"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef int(*&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__rtdmirq.html#gadabd8f3473098ae9128ef449a83fe3c2">rtdm_irq_handler_t</a> )(rtdm_irq_t *irq_handle)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Interrupt handler.  <a href="#gadabd8f3473098ae9128ef449a83fe3c2"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__rtdmirq.html#ga9bb3d95218ac5261e4033fb0bf695073">rtdm_irq_request</a> (rtdm_irq_t *irq_handle, unsigned int irq_no, <a class="el" href="group__rtdmirq.html#gadabd8f3473098ae9128ef449a83fe3c2">rtdm_irq_handler_t</a> handler, unsigned long flags, const char *device_name, void *arg)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Register an interrupt handler.  <a href="#ga9bb3d95218ac5261e4033fb0bf695073"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__rtdmirq.html#gaf246c0d9fa42a18afbeabd3e3c087c8e">rtdm_irq_free</a> (rtdm_irq_t *irq_handle)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Release an interrupt handler.  <a href="#gaf246c0d9fa42a18afbeabd3e3c087c8e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__rtdmirq.html#ga231362e861125cfdcbe5b4137fc70680">rtdm_irq_enable</a> (rtdm_irq_t *irq_handle)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Enable interrupt line.  <a href="#ga231362e861125cfdcbe5b4137fc70680"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__rtdmirq.html#gab34c102e3e8af1f27786b2996247913d">rtdm_irq_disable</a> (rtdm_irq_t *irq_handle)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Disable interrupt line.  <a href="#gab34c102e3e8af1f27786b2996247913d"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="member-group"></a>
RTDM_IRQTYPE_xxx</h2></td></tr>
<tr><td colspan="2"><p><a class="anchor" id="amgrpb40f3fc6900a5e6be96e288e1ff0a042"></a> <a class="anchor" id="RTDM_IRQTYPE_xxx"></a> Interrupt registrations flags </p>
<br/><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gab26458b2383dd59b4977cd77c948cdfc"></a><!-- doxytag: member="rtdmirq::RTDM_IRQTYPE_SHARED" ref="gab26458b2383dd59b4977cd77c948cdfc" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__rtdmirq.html#gab26458b2383dd59b4977cd77c948cdfc">RTDM_IRQTYPE_SHARED</a>&nbsp;&nbsp;&nbsp;XN_ISR_SHARED</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Enable IRQ-sharing with other real-time drivers. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gaf4e76db13d7f7aac4be2cae59e0097bc"></a><!-- doxytag: member="rtdmirq::RTDM_IRQTYPE_EDGE" ref="gaf4e76db13d7f7aac4be2cae59e0097bc" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__rtdmirq.html#gaf4e76db13d7f7aac4be2cae59e0097bc">RTDM_IRQTYPE_EDGE</a>&nbsp;&nbsp;&nbsp;XN_ISR_EDGE</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Mark IRQ as edge-triggered, relevant for correct handling of shared edge-triggered IRQs. <br/></td></tr>
<tr><td colspan="2"><h2><a name="member-group"></a>
RTDM_IRQ_xxx</h2></td></tr>
<tr><td colspan="2"><p><a class="anchor" id="amgrpe555ee13ceceddc5283bdc9a274b3648"></a> <a class="anchor" id="RTDM_IRQ_xxx"></a> Return flags of interrupt handlers </p>
<br/><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gad7b7593bdac7e1595635f2b372110d22"></a><!-- doxytag: member="rtdmirq::RTDM_IRQ_NONE" ref="gad7b7593bdac7e1595635f2b372110d22" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__rtdmirq.html#gad7b7593bdac7e1595635f2b372110d22">RTDM_IRQ_NONE</a>&nbsp;&nbsp;&nbsp;XN_ISR_NONE</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Unhandled interrupt. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga56a2e243364bc9ff0e38c031c4c8ad57"></a><!-- doxytag: member="rtdmirq::RTDM_IRQ_HANDLED" ref="ga56a2e243364bc9ff0e38c031c4c8ad57" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__rtdmirq.html#ga56a2e243364bc9ff0e38c031c4c8ad57">RTDM_IRQ_HANDLED</a>&nbsp;&nbsp;&nbsp;XN_ISR_HANDLED</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Denote handled interrupt. <br/></td></tr>
</table>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="gac99789fe8b6b48e032ee6c22544968e4"></a><!-- doxytag: member="rtdm_driver.h::rtdm_irq_get_arg" ref="gac99789fe8b6b48e032ee6c22544968e4" args="(irq_handle, type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define rtdm_irq_get_arg</td>
          <td>(</td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname">irq_handle, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname">type</td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td>&nbsp;&nbsp;&nbsp;((type *)irq_handle-&gt;cookie)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Retrieve IRQ handler argument. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>irq_handle</em>&nbsp;</td><td>IRQ handle </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>type</em>&nbsp;</td><td>Type of the pointer to return</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The argument pointer registered on <a class="el" href="group__rtdmirq.html#ga9bb3d95218ac5261e4033fb0bf695073" title="Register an interrupt handler.">rtdm_irq_request()</a> is returned, type-casted to the specified <em>type</em>.</dd></dl>
<p>Environments:</p>
<p>This service can be called from:</p>
<ul>
<li>Interrupt service routine</li>
</ul>
<p>Rescheduling: never. </p>

</div>
</div>
<hr/><h2>Typedef Documentation</h2>
<a class="anchor" id="gadabd8f3473098ae9128ef449a83fe3c2"></a><!-- doxytag: member="rtdm_driver.h::rtdm_irq_handler_t" ref="gadabd8f3473098ae9128ef449a83fe3c2" args=")(rtdm_irq_t *irq_handle)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef int(* <a class="el" href="group__rtdmirq.html#gadabd8f3473098ae9128ef449a83fe3c2">rtdm_irq_handler_t</a>)(rtdm_irq_t *irq_handle)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Interrupt handler. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>irq_handle</em>&nbsp;</td><td>IRQ handle as returned by <a class="el" href="group__rtdmirq.html#ga9bb3d95218ac5261e4033fb0bf695073" title="Register an interrupt handler.">rtdm_irq_request()</a></td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 or a combination of <a class="el" href="group__rtdmirq.html#RTDM_IRQ_xxx">RTDM_IRQ_xxx</a> flags </dd></dl>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="gab34c102e3e8af1f27786b2996247913d"></a><!-- doxytag: member="drvlib.c::rtdm_irq_disable" ref="gab34c102e3e8af1f27786b2996247913d" args="(rtdm_irq_t *irq_handle)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rtdm_irq_disable </td>
          <td>(</td>
          <td class="paramtype">rtdm_irq_t *&nbsp;</td>
          <td class="paramname"> <em>irq_handle</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Disable interrupt line. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>irq_handle</em>&nbsp;</td><td>IRQ handle as returned by <a class="el" href="group__rtdmirq.html#ga9bb3d95218ac5261e4033fb0bf695073" title="Register an interrupt handler.">rtdm_irq_request()</a></td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 on success, otherwise negative error code</dd></dl>
<dl class="note"><dt><b>Note:</b></dt><dd>This service is for exceptional use only. Drivers should always prefer interrupt masking at device level (via corresponding control registers etc.) over masking at line level. Keep in mind that the latter is incompatible with IRQ line sharing and can also be more costly as interrupt controller access requires broader synchronization. Also, certain IRQ types may not allow the invocation over RT and interrupt contexts. The caller is responsible for excluding such conflicts.</dd></dl>
<p>Environments:</p>
<p>This service can be called from:</p>
<ul>
<li>Kernel module initialization/cleanup code</li>
<li>Interrupt service routine</li>
<li>Kernel-based task</li>
<li>User-space task (RT, non-RT)</li>
</ul>
<p>Rescheduling: never. </p>

</div>
</div>
<a class="anchor" id="ga231362e861125cfdcbe5b4137fc70680"></a><!-- doxytag: member="drvlib.c::rtdm_irq_enable" ref="ga231362e861125cfdcbe5b4137fc70680" args="(rtdm_irq_t *irq_handle)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rtdm_irq_enable </td>
          <td>(</td>
          <td class="paramtype">rtdm_irq_t *&nbsp;</td>
          <td class="paramname"> <em>irq_handle</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Enable interrupt line. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>irq_handle</em>&nbsp;</td><td>IRQ handle as returned by <a class="el" href="group__rtdmirq.html#ga9bb3d95218ac5261e4033fb0bf695073" title="Register an interrupt handler.">rtdm_irq_request()</a></td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 on success, otherwise negative error code</dd></dl>
<dl class="note"><dt><b>Note:</b></dt><dd>This service is for exceptional use only. Drivers should always prefer interrupt masking at device level (via corresponding control registers etc.) over masking at line level. Keep in mind that the latter is incompatible with IRQ line sharing and can also be more costly as interrupt controller access requires broader synchronization. Also, certain IRQ types may not allow the invocation over RT and interrupt contexts. The caller is responsible for excluding such conflicts.</dd></dl>
<p>Environments:</p>
<p>This service can be called from:</p>
<ul>
<li>Kernel module initialization/cleanup code</li>
<li>Interrupt service routine</li>
<li>Kernel-based task</li>
<li>User-space task (RT, non-RT)</li>
</ul>
<p>Rescheduling: possible. </p>

</div>
</div>
<a class="anchor" id="gaf246c0d9fa42a18afbeabd3e3c087c8e"></a><!-- doxytag: member="drvlib.c::rtdm_irq_free" ref="gaf246c0d9fa42a18afbeabd3e3c087c8e" args="(rtdm_irq_t *irq_handle)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rtdm_irq_free </td>
          <td>(</td>
          <td class="paramtype">rtdm_irq_t *&nbsp;</td>
          <td class="paramname"> <em>irq_handle</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Release an interrupt handler. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>irq_handle</em>&nbsp;</td><td>IRQ handle as returned by <a class="el" href="group__rtdmirq.html#ga9bb3d95218ac5261e4033fb0bf695073" title="Register an interrupt handler.">rtdm_irq_request()</a></td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 on success, otherwise negative error code</dd></dl>
<dl class="note"><dt><b>Note:</b></dt><dd>The caller is responsible for shutting down the IRQ source at device level before invoking this service. In turn, rtdm_irq_free ensures that any pending event on the given IRQ line is fully processed on return from this service.</dd></dl>
<p>Environments:</p>
<p>This service can be called from:</p>
<ul>
<li>Kernel module initialization/cleanup code</li>
<li>User-space task (non-RT)</li>
</ul>
<p>Rescheduling: never. </p>

</div>
</div>
<a class="anchor" id="ga9bb3d95218ac5261e4033fb0bf695073"></a><!-- doxytag: member="drvlib.c::rtdm_irq_request" ref="ga9bb3d95218ac5261e4033fb0bf695073" args="(rtdm_irq_t *irq_handle, unsigned int irq_no, rtdm_irq_handler_t handler, unsigned long flags, const char *device_name, void *arg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rtdm_irq_request </td>
          <td>(</td>
          <td class="paramtype">rtdm_irq_t *&nbsp;</td>
          <td class="paramname"> <em>irq_handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>irq_no</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__rtdmirq.html#gadabd8f3473098ae9128ef449a83fe3c2">rtdm_irq_handler_t</a>&nbsp;</td>
          <td class="paramname"> <em>handler</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&nbsp;</td>
          <td class="paramname"> <em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>device_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>arg</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Register an interrupt handler. </p>
<p>This function registers the provided handler with an IRQ line and enables the line.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>irq_handle</em>&nbsp;</td><td>IRQ handle </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>irq_no</em>&nbsp;</td><td>Line number of the addressed IRQ </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>handler</em>&nbsp;</td><td>Interrupt handler </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>flags</em>&nbsp;</td><td>Registration flags, see <a class="el" href="group__rtdmirq.html#RTDM_IRQTYPE_xxx">RTDM_IRQTYPE_xxx</a> for details </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>device_name</em>&nbsp;</td><td>Device name to show up in real-time IRQ lists </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>arg</em>&nbsp;</td><td>Pointer to be passed to the interrupt handler on invocation</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 on success, otherwise:</dd></dl>
<ul>
<li>-EINVAL is returned if an invalid parameter was passed.</li>
</ul>
<ul>
<li>-EBUSY is returned if the specified IRQ line is already in use.</li>
</ul>
<p>Environments:</p>
<p>This service can be called from:</p>
<ul>
<li>Kernel module initialization/cleanup code</li>
<li>User-space task (non-RT)</li>
</ul>
<p>Rescheduling: never. </p>

<p>References <a class="el" href="group__intr.html#ga52a4435332aa1dbdc18edb58231c83f0">xnintr_attach()</a>, <a class="el" href="group__intr.html#ga83769b98f398774590e57ad8664925aa">xnintr_detach()</a>, <a class="el" href="group__intr.html#ga083e000abd434e4d0fca8f6b6bbd49de">xnintr_enable()</a>, and <a class="el" href="group__intr.html#ga6017e33c5871d313b4de053d938dd95b">xnintr_init()</a>.</p>

</div>
</div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Wed Jan 23 2013 13:24:04 for Xenomai API by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
